<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover, height=device-height, user-scalable=no"
    />
    <meta name="apple-mobile-web-app-capable" content="no" />
    <meta name="mobile-web-app-capable" content="no" />
    <title>Vite + React</title>
    <style>
      :root {
        --vh: 1vh; /* Default value, will be set by JS */
      }
      html {
        height: 100%;
        height: calc(var(--vh, 1vh) * 100);
        margin: 0;
        padding: 0;
        background-color: transparent; /* Allow background image to show */
        overscroll-behavior-y: contain; /* Less restrictive than 'none' */
      }
      body {
        height: 100%;
        height: calc(var(--vh, 1vh) * 100);
        margin: 0;
        padding: 0;
        overflow-x: hidden;
        overflow-y: auto; /* Enable scrolling */
        background-color: transparent; /* Allow background image to show */
        position: relative; /* Create stacking context */
      }
      /* Hide scrollbar for Chrome, Safari and Opera */
      body::-webkit-scrollbar {
        display: none;
      }
      /* Hide scrollbar for IE, Edge and Firefox */
      body {
        -ms-overflow-style: none; /* IE and Edge */
        scrollbar-width: none; /* Firefox */
      }
      #root {
        min-height: 100%;
        min-height: calc(var(--vh, 1vh) * 100);
        -webkit-overflow-scrolling: touch;
        position: relative; /* Ensure proper stacking */
      }
      /* Fix for iOS Safari */
      @supports (-webkit-touch-callout: none) {
        html,
        body,
        #root {
          height: -webkit-fill-available;
        }
        /* Ensure background image displays correctly on iOS */
        .terms-container {
          background-attachment: fixed !important;
          background-size: cover !important;
          background-position: center !important;
        }
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
    <script>
      // Handle mobile viewport issues with URL bar
      (function () {
        // Set the --vh custom property based on the actual viewport height
        function setVhProperty() {
          const vh = window.innerHeight * 0.01;
          document.documentElement.style.setProperty("--vh", `${vh}px`);
        }

        // Set it on initial load
        setVhProperty();

        // Create a div that extends beyond the viewport to prevent white space
        function createBackgroundExtension() {
          // Don't create the extension as it blocks the background image
        }

        if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
          // For mobile devices
          window.addEventListener("load", function () {
            // Create background extension to prevent white space
            createBackgroundExtension();

            // Initial setup
            setVhProperty();

            // Don't apply transforms that might interfere with scrolling

            // Force a small scroll to normalize the URL bar state
            setTimeout(function () {
              window.scrollTo(0, 1);
              setTimeout(setVhProperty, 50);
            }, 0);

            // Handle scroll events
            let lastScrollPosition = 0;
            let isFirstScroll = true;
            let scrollTimer = null;

            window.addEventListener(
              "scroll",
              function () {
                // Clear any existing timer
                clearTimeout(scrollTimer);

                // Special handling for first scroll (when URL bar typically hides)
                if (isFirstScroll) {
                  // Just mark as scrolled without changing background color
                  isFirstScroll = false;
                }

                // Set a timer to update after scrolling stops
                scrollTimer = setTimeout(function () {
                  setVhProperty();
                }, 100);

                lastScrollPosition = window.scrollY;
              },
              { passive: true }
            );

            // Update on resize and orientation change
            window.addEventListener(
              "resize",
              function () {
                setVhProperty();
                // Don't set background color to allow image to show
              },
              { passive: true }
            );

            window.addEventListener(
              "orientationchange",
              function () {
                // Delay to ensure correct height after orientation change
                setTimeout(function () {
                  setVhProperty();
                  // Don't set background color to allow image to show
                }, 100);
              },
              { passive: true }
            );
          });
        }
      })();
    </script>
  </body>
</html>
